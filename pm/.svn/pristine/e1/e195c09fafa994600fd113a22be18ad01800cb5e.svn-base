package com.cninsure.payment.util;

import java.security.SecureRandom;

import javax.crypto.Cipher;
import javax.crypto.KeyGenerator;
import javax.crypto.SecretKey;
import javax.crypto.spec.SecretKeySpec;

public class AESUtil {

	/**
	 * 密钥算法
	 */
	private static final String ALGORITHM = "AES";
	/**
	 * 加解密算法/工作模式/填充方式
	 */
	private static final String ALGORITHM_MODE_PADDING = "AES/ECB/PKCS5Padding";

	private static SecretKeySpec key = new SecretKeySpec(MD5Util.MD5Encode("j83iKSy9FC7RpHzOTWFRTfjvWhhEyGDQ", "UTF-8").toLowerCase().getBytes(),
			ALGORITHM);;

	public static void initKey(String password) {
		try {
			KeyGenerator kgen = KeyGenerator.getInstance("AES");
			kgen.init(256, new SecureRandom(password.getBytes()));
			SecretKey secretKey = kgen.generateKey();
			byte[] enCodeFormat = secretKey.getEncoded();
			key = new SecretKeySpec(enCodeFormat, "AES");
		}
		catch (Exception e) {
			e.printStackTrace();
		}

	}

	/**
	 * AES加密
	 * 
	 * @param data
	 * @return
	 * @throws Exception
	 */
	public static String encryptData(String data) throws Exception {
		// 创建密码器
		Cipher cipher = Cipher.getInstance(ALGORITHM_MODE_PADDING);
		// 初始化
		cipher.init(Cipher.ENCRYPT_MODE, key);
		return Base64Util.encode(cipher.doFinal(data.getBytes()));
	}

	/**
	 * AES解密
	 * 
	 * @param base64Data
	 * @return
	 * @throws Exception
	 */
	public static String decryptData(String base64Data) throws Exception {
		Cipher cipher = Cipher.getInstance(ALGORITHM_MODE_PADDING);
		cipher.init(Cipher.DECRYPT_MODE, key);
		return new String(cipher.doFinal(Base64Util.decode(base64Data)));
	}

	public static void main(String[] args) throws Exception {
		// System.out.println(encryptData("1234")); // 加密
		String A = "A0TYx3jPuE1qA2r7nRGjlFpM9ATG8qDHRW7y9Dew160o4aag99fDjGWtrSoeH7j5v0uPunj00s2JlxMwq0hVCD8QpZ1wg+7srSOIDb+vf3omN83ntJFDGRlRvwoaSbUfeM8INwK+A1D/n9UmrCt4E4K0Rb3CT6nhFCvtnahBMNA50RnHC8zkbGDQYkCmJjqGMNebkNxtVoFUDm/dneofCbVYyh9wryQzVKX/VZuio04viyJzj+PDvkj3inIr2oL6X33hS9Rlfvj87EDhL3fBgw/xqiGtrTDF+vj0DTGu0mNT1JjrBfxffn61CThVYhSuf8b/mFjLkIXo3uoIN0Wn81n/6NHP9nsZJs/SecLyLczb3O055lqdQKJyqH7ziun2v3X9UQ/zh4MjH6wcqd0nLahygATHVj6EqFxs8cG8mFt1qEi4/+Az1fgdMPPl+KMnd8/PHlCJAYixPbMhyIuJhDfeiPz4Kx0PnKRae+I11NnDxNwx34B7K3tENfb+OhNZAfTjkc1Z0T7yKq73g0WmreWBwVl1N8mYomePMDTwVX1BEXJ71P4Fwk5IuTq5pzJp9iEDEK1IkyKD5J/lb19aAg5ap6a7Sja3T3YMqszmv0UlQOFLGerfx5uhDUoPefoQ2lUOTlcR6PklUqHx9s85pY1cUd8pLqo6CS63qnJwgepMkdsiemdZ6vZYmKW8tJ43E/wRH3dgc3pbCXDlU+C7xmJXdcCSvaw4M0TzPs+h38Zpe0dgQ6nUXJ/Uf2rZ1l3YV2p/fXt6gJuoTkStsIFfau3xM8rswo/ESKCitdhIEMvJP0/Wd5/mNHkMhiQpONoRge2bx8lFbl6dE2zaa8BTHm8tU4HHy2n1ef3CSr0UpLYEANJjaVzQ0bZXbsLZVdvAD/GqIa2tMMX6+PQNMa7SYxVLqqOxtGiR2a2+npyduzYFWk+AjN+ag/e26ycqWQZdtJbEWIGpUyNA6CVIvMOiRRz3k9auwEIUfLgQmaSGE1sbmoeIAnQ6g0b1lKBH23Xk8vBrNdjgvPvSiAW4xuFV0OEAVR6pgE+gR8U1gRw9I4c=";
		String B = AESUtil.decryptData(A);
		System.out.println(B); // 解密
	}

}
