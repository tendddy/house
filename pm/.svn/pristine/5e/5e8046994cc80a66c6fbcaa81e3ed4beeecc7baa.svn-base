<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cninsure.payment.entity">
	<resultMap id="PMPaymentMap" type="com.cninsure.payment.entity.PMPayment" >
    <id column="id" property="id" jdbcType="BIGINT" />
    <result column="createdate" property="createdate" jdbcType="TIMESTAMP" />
    <result column="modifydate" property="modifydate" jdbcType="TIMESTAMP" />
    <result column="app_id" property="appId" jdbcType="BIGINT" />
    <result column="platform_id" property="platformId" jdbcType="BIGINT" />
    <result column="bankcard_id" property="bankcardId" jdbcType="BIGINT" />
    <result column="protocolid" property="protocolid" jdbcType="VARCHAR" />
    <result column="payprotocolid" property="payProtocolid" jdbcType="VARCHAR" />
    <result column="orderid" property="orderid" jdbcType="VARCHAR" />
    <result column="ordername" property="ordername" jdbcType="VARCHAR" />
    <result column="app_orderid" property="appOrderId" jdbcType="CHAR" />
    <result column="orderfee" property="orderfee" jdbcType="INTEGER" />
    <result column="payfee" property="payfee" jdbcType="INTEGER" />
    <result column="pay_type" property="payType" jdbcType="CHAR" />
    <result column="orderdatetime" property="orderdatetime" jdbcType="CHAR" />
    <result column="verifycode" property="verifycode" jdbcType="VARCHAR" />
    <result column="bind_card_verifycode" property="bindCardVerifycode" jdbcType="VARCHAR" />
    <result column="corpid" property="corpid" jdbcType="VARCHAR" />
    <result column="itemid" property="itemid" jdbcType="VARCHAR" />
    <result column="corpuserid" property="corpuserid" jdbcType="VARCHAR" />
    <result column="corpusername" property="corpusername" jdbcType="VARCHAR" />
    <result column="status" property="status" jdbcType="CHAR" />
    <result column="payresultcode" property="payresultcode" jdbcType="VARCHAR" />
    <result column="payresultmsg" property="payresultmsg" jdbcType="VARCHAR" />
    <result column="receiveurl" property="receiveurl" jdbcType="VARCHAR" />
    <result column="userinfourl" property="userinfourl" jdbcType="VARCHAR" />
    <result column="app_user_id" property="appUserId" jdbcType="VARCHAR" />
    <result column="mch_id" property="mchId" jdbcType="VARCHAR" />
    <result column="prop1" property="prop1" jdbcType="VARCHAR" />
	<result column="prop2" property="prop2" jdbcType="VARCHAR" />
	<result column="prop3" property="prop3" jdbcType="VARCHAR" />
	<result column="prop4" property="prop4" jdbcType="VARCHAR" />
	<result column="prop5" property="prop5" jdbcType="VARCHAR" />
  </resultMap>
	<!-- PMPayment -->
	<insert id="PMPayment_insert" useGeneratedKeys="true" keyProperty="id" parameterType="com.cninsure.payment.entity.PMPayment" >
		insert into PMPayment
		(createdate,modifydate,app_id,app_orderid,platform_id,bankcard_id,protocolid,payprotocolid,orderid,ordername,orderfee,payfee,pay_type,orderdatetime,verifycode,bind_card_verifycode,corpid,itemid,corpuserid,corpusername,status,payresultcode,payresultmsg,receiveurl,userinfourl,app_user_id,mch_id,prop1,prop2,prop3,prop4,prop5) 
		values
		(#{createdate, jdbcType=TIMESTAMP},#{modifydate, jdbcType=TIMESTAMP},#{appId, jdbcType=BIGINT},#{appOrderId, jdbcType=CHAR},#{platformId, jdbcType=BIGINT},#{bankcardId, jdbcType=BIGINT},#{protocolid, jdbcType=VARCHAR},#{payProtocolid, jdbcType=VARCHAR},#{orderid, jdbcType=VARCHAR},#{ordername, jdbcType=VARCHAR},#{orderfee, jdbcType=INTEGER},#{payfee, jdbcType=INTEGER},#{payType, jdbcType=CHAR},#{orderdatetime, jdbcType=CHAR},#{verifycode, jdbcType=VARCHAR},#{bindCardVerifycode, jdbcType=VARCHAR},#{corpid, jdbcType=VARCHAR},#{itemid, jdbcType=VARCHAR},#{corpuserid, jdbcType=VARCHAR},#{corpusername, jdbcType=VARCHAR},#{status, jdbcType=CHAR},#{payresultcode, jdbcType=VARCHAR},#{payresultmsg, jdbcType=VARCHAR},#{receiveurl, jdbcType=VARCHAR},#{userinfourl, jdbcType=VARCHAR},#{appUserId, jdbcType=VARCHAR},#{mchId, jdbcType=VARCHAR},#{prop1, jdbcType=VARCHAR},#{prop2, jdbcType=VARCHAR},#{prop3, jdbcType=VARCHAR},#{prop4, jdbcType=VARCHAR},#{prop5, jdbcType=VARCHAR}) 
	</insert>
	<select id="PMPayment_select" parameterType="Map" resultMap="PMPaymentMap">
		select * from PMPayment
		<where>
			<if test="id != null">
				and id = #{id, jdbcType=BIGINT}
			</if>
			<if test="createdate != null">
				and createdate = #{createdate, jdbcType=TIMESTAMP}
			</if>
			<if test="modifydate != null">
				and modifydate = #{modifydate, jdbcType=TIMESTAMP}
			</if>
			<if test="appId != null">
				and app_id = #{appId, jdbcType=BIGINT}
			</if>
			<if test="platformId != null">
				and platform_id = #{platformId, jdbcType=BIGINT}
			</if>
			<if test="bankcardId != null">
				and bankcard_id = #{bankcardId, jdbcType=BIGINT}
			</if>
			<if test="protocolid != null">
				and protocolid = #{protocolid, jdbcType=VARCHAR}
			</if>
			<if test="payProtocolid != null">
				and payprotocolid = #{payProtocolid, jdbcType=VARCHAR}
			</if>
			<if test="orderid != null">
				and orderid = #{orderid, jdbcType=VARCHAR}
			</if>
			<if test="ordername != null">
				and ordername = #{ordername, jdbcType=VARCHAR}
			</if>
			<if test="appOrderId != null">
				and app_orderid = #{appOrderId, jdbcType=CHAR}
			</if>
			<if test="orderfee != null">
				and orderfee = #{orderfee, jdbcType=INTEGER}
			</if>
			<if test="payfee != null">
				and payfee = #{payfee, jdbcType=INTEGER}
			</if>
			<if test="payType != null">
				and pay_type = #{payType, jdbcType=CHAR}
			</if>
			<if test="orderdatetime != null">
				and orderdatetime = #{orderdatetime, jdbcType=CHAR}
			</if>
			<if test="verifycode != null">
				and verifycode = #{verifycode, jdbcType=VARCHAR}
			</if>
			<if test="bindCardVerifycode != null">
				and bind_card_verifycode = #{bindCardVerifycode, jdbcType=VARCHAR}
			</if>
			<if test="corpid != null">
				and corpid = #{corpid, jdbcType=VARCHAR}
			</if>
			<if test="itemid != null">
				and itemid = #{itemid, jdbcType=VARCHAR}
			</if>
			<if test="corpuserid != null">
				and corpuserid = #{corpuserid, jdbcType=VARCHAR}
			</if>
			<if test="corpusername != null">
				and corpusername = #{corpusername, jdbcType=VARCHAR}
			</if>
			<if test="status != null">
				and status = #{status, jdbcType=CHAR}
			</if>
			<if test="payresultcode != null">
				and payresultcode = #{payresultcode, jdbcType=VARCHAR}
			</if>
			<if test="payresultmsg != null">
				and payresultmsg = #{payresultmsg, jdbcType=VARCHAR}
			</if>
			<if test="receiveurl != null">
				and receiveurl = #{receiveurl, jdbcType=VARCHAR}
			</if>
			<if test="userinfourl != null">
				and userinfourl = #{userinfourl, jdbcType=VARCHAR}
			</if>
			<if test="appUserId != null">
				and app_user_id = #{appUserId, jdbcType=VARCHAR}
			</if>
			<if test="prop1 != null">
				and prop1 = #{prop1, jdbcType=VARCHAR}
			</if>
			<if test="prop2 != null">
				and prop2 = #{prop2, jdbcType=VARCHAR}
			</if>
			<if test="prop3 != null">
				and prop3 = #{prop3, jdbcType=VARCHAR}
			</if>
			<if test="prop4 != null">
				and prop4 = #{prop4, jdbcType=VARCHAR}
			</if>
			<if test="prop5 != null">
				and prop5 = #{prop5, jdbcType=VARCHAR}
			</if>
		</where>
	</select>
	<select id="PMPayment_selectById" parameterType="Long" resultMap="PMPaymentMap">
		select * from PMPayment where id = #{id}
	</select>
	<select id="PMPayment_selectByPayProtocol" parameterType="String" resultMap="PMPaymentMap">
		select * from PMPayment where payprotocolid = #{value}
	</select>
	<select id="PMPayment_selectBypaymentId" parameterType="String" resultMap="PMPaymentMap">
		select * from PMPayment where id = #{value}
	</select>
	<select id="PMPayment_deleteById" parameterType="Long">
		delete from PMPayment where id = #{id}
	</select>
	<select id="PMPayment_updateById" parameterType="com.cninsure.payment.entity.PMPayment">
		update PMPayment  set 
			id = #{id, jdbcType=BIGINT},
			createdate = #{createdate, jdbcType=TIMESTAMP},
			modifydate = #{modifydate, jdbcType=TIMESTAMP},
			app_id = #{appId, jdbcType=BIGINT},
			app_orderid = #{appOrderId, jdbcType=CHAR},
			platform_id = #{platformId, jdbcType=BIGINT},
			bankcard_id = #{bankcardId, jdbcType=BIGINT},
			protocolid = #{protocolid, jdbcType=VARCHAR},
			payprotocolid = #{payProtocolid, jdbcType=VARCHAR},
			orderid = #{orderid, jdbcType=VARCHAR},
			ordername = #{ordername, jdbcType=VARCHAR},
			orderfee = #{orderfee, jdbcType=INTEGER},
			payfee = #{payfee, jdbcType=INTEGER},
			pay_type = #{payType, jdbcType=CHAR},
			orderdatetime = #{orderdatetime, jdbcType=CHAR},
			verifycode = #{verifycode, jdbcType=VARCHAR},
			bind_card_verifycode = #{bindCardVerifycode, jdbcType=VARCHAR},
			corpid = #{corpid, jdbcType=VARCHAR},
			itemid = #{itemid, jdbcType=VARCHAR},
			corpuserid = #{corpuserid, jdbcType=VARCHAR},corpusername = #{corpusername, jdbcType=VARCHAR},
			status = #{status, jdbcType=CHAR},payresultcode = #{payresultcode, jdbcType=VARCHAR},
			payresultmsg = #{payresultmsg, jdbcType=VARCHAR},receiveurl = #{receiveurl, jdbcType=VARCHAR},
			userinfourl = #{userinfourl, jdbcType=VARCHAR},app_user_id = #{appUserId, jdbcType=VARCHAR},
			mch_id = #{mchId, jdbcType=VARCHAR},
			prop1 = #{prop1, jdbcType=VARCHAR},prop2 = #{prop2, jdbcType=VARCHAR},prop3 = #{prop3, jdbcType=VARCHAR},
			prop4 = #{prop4, jdbcType=VARCHAR},prop5 = #{prop5, jdbcType=VARCHAR}
			where id = #{id}
	</select>
	<update id="PMPayment_updateByIdSelective" parameterType="com.cninsure.payment.entity.PMPayment">
		update PMPayment 
		<set>
			<if test="createdate !=null">
				createdate = #{createdate, jdbcType=TIMESTAMP},
			</if>
			<if test="modifydate !=null">
				modifydate = #{modifydate, jdbcType=TIMESTAMP},
			</if>
			<if test="appId !=null">
				app_id = #{appId, jdbcType=BIGINT},
			</if>
			<if test="platformId !=null">
				platform_id = #{platformId, jdbcType=BIGINT},
			</if>
			<if test="protocolid !=null">
				protocolid = #{protocolid, jdbcType=VARCHAR},
			</if>
			<if test="payProtocolid !=null">
				payprotocolid = #{payProtocolid, jdbcType=VARCHAR},
			</if>
			<if test="orderid !=null">
				orderid = #{orderid, jdbcType=VARCHAR},
			</if>
			<if test="ordername !=null">
				ordername = #{ordername, jdbcType=VARCHAR},
			</if>
			<if test="appOrderId !=null">
				app_orderid = #{appOrderId, jdbcType=CHAR},
			</if>
			<if test="orderfee !=null">
				orderfee = #{orderfee, jdbcType=INTEGER},
			</if>
			<if test="payfee !=null">
				payfee = #{payfee, jdbcType=INTEGER},
			</if>
			<if test="payType !=null">
				pay_type = #{payType, jdbcType=CHAR},
			</if>
			<if test="orderdatetime !=null">
				orderdatetime = #{orderdatetime, jdbcType=CHAR},
			</if>
			<if test="verifycode !=null">
				verifycode = #{verifycode, jdbcType=VARCHAR},
			</if>
			<if test="bindCardVerifycode != null">
				bind_card_verifycode = #{bindCardVerifycode, jdbcType=VARCHAR},
			</if>
			<if test="corpid !=null">
				corpid = #{corpid, jdbcType=VARCHAR},
			</if>
			<if test="itemid !=null">
				itemid = #{itemid, jdbcType=VARCHAR},
			</if>
			<if test="corpuserid !=null">
				corpuserid = #{corpuserid, jdbcType=VARCHAR},
			</if>
			<if test="corpusername !=null">
				corpusername = #{corpusername, jdbcType=VARCHAR},
			</if>
			<if test="status !=null">
				status = #{status, jdbcType=CHAR},
			</if>
			<if test="payresultcode !=null">
				payresultcode = #{payresultcode, jdbcType=VARCHAR},
			</if>
			<if test="payresultmsg !=null">
				payresultmsg = #{payresultmsg, jdbcType=VARCHAR},
			</if>
			<if test="receiveurl !=null">
				receiveurl = #{receiveurl, jdbcType=VARCHAR},
			</if>
			<if test="userinfourl !=null">
				userinfourl = #{userinfourl, jdbcType=VARCHAR},
			</if>
			<if test="appUserId !=null">
				app_user_id = #{appUserId, jdbcType=VARCHAR} 
			</if>
			<if test="mchId !=null">
				mch_id = #{mchId, jdbcType=VARCHAR} 
			</if>
			<if test="prop1 != null">
				and prop1 = #{prop1, jdbcType=VARCHAR}
			</if>
			<if test="prop2 != null">
				and prop2 = #{prop2, jdbcType=VARCHAR}
			</if>
			<if test="prop3 != null">
				and prop3 = #{prop3, jdbcType=VARCHAR}
			</if>
			<if test="prop4 != null">
				and prop4 = #{prop4, jdbcType=VARCHAR}
			</if>
			<if test="prop5 != null">
				and prop5 = #{prop5, jdbcType=VARCHAR}
			</if>
		</set>
			where id = #{id}
	</update>
	<update id="PMPayment_updateByPayProtocolIdSelective" parameterType="com.cninsure.payment.entity.PMPayment">
		update PMPayment 
		<set>
			<if test="createdate !=null">
				createdate = #{createdate, jdbcType=TIMESTAMP},
			</if>
			<if test="modifydate !=null">
				modifydate = #{modifydate, jdbcType=TIMESTAMP},
			</if>
			<if test="appId !=null">
				app_id = #{appId, jdbcType=BIGINT},
			</if>
			<if test="platformId !=null">
				platform_id = #{platformId, jdbcType=BIGINT},
			</if>
			<if test="protocolid !=null">
				protocolid = #{protocolid, jdbcType=VARCHAR},
			</if>
			<if test="orderid !=null">
				orderid = #{orderid, jdbcType=VARCHAR},
			</if>
			<if test="ordername !=null">
				ordername = #{ordername, jdbcType=VARCHAR},
			</if>
			<if test="appOrderId !=null">
				app_orderid = #{appOrderId, jdbcType=CHAR},
			</if>
			<if test="orderfee !=null">
				orderfee = #{orderfee, jdbcType=INTEGER},
			</if>
			<if test="payfee !=null">
				payfee = #{payfee, jdbcType=INTEGER},
			</if>
			<if test="payType !=null">
				pay_type = #{payType, jdbcType=CHAR},
			</if>
			<if test="orderdatetime !=null">
				orderdatetime = #{orderdatetime, jdbcType=CHAR},
			</if>
			<if test="verifycode !=null">
				verifycode = #{verifycode, jdbcType=VARCHAR},
			</if>
			<if test="bindCardVerifycode != null">
				bind_card_verifycode = #{bindCardVerifycode, jdbcType=VARCHAR},
			</if>
			<if test="corpid !=null">
				corpid = #{corpid, jdbcType=VARCHAR},
			</if>
			<if test="itemid !=null">
				itemid = #{itemid, jdbcType=VARCHAR},
			</if>
			<if test="corpuserid !=null">
				corpuserid = #{corpuserid, jdbcType=VARCHAR},
			</if>
			<if test="corpusername !=null">
				corpusername = #{corpusername, jdbcType=VARCHAR},
			</if>
			<if test="status !=null">
				status = #{status, jdbcType=CHAR},
			</if>
			<if test="payresultcode !=null">
				payresultcode = #{payresultcode, jdbcType=VARCHAR},
			</if>
			<if test="payresultmsg !=null">
				payresultmsg = #{payresultmsg, jdbcType=VARCHAR},
			</if>
			<if test="receiveurl !=null">
				receiveurl = #{receiveurl, jdbcType=VARCHAR},
			</if>
			<if test="userinfourl !=null">
				userinfourl = #{userinfourl, jdbcType=VARCHAR},
			</if>
			<if test="appUserId !=null">
				app_user_id = #{appUserId, jdbcType=VARCHAR} 
			</if>
			<if test="mchId !=null">
				mch_id = #{mchId, jdbcType=VARCHAR} 
			</if>
			<if test="prop1 != null">
				and prop1 = #{prop1, jdbcType=VARCHAR}
			</if>
			<if test="prop2 != null">
				and prop2 = #{prop2, jdbcType=VARCHAR}
			</if>
			<if test="prop3 != null">
				and prop3 = #{prop3, jdbcType=VARCHAR}
			</if>
			<if test="prop4 != null">
				and prop4 = #{prop4, jdbcType=VARCHAR}
			</if>
			<if test="prop5 != null">
				and prop5 = #{prop5, jdbcType=VARCHAR}
			</if>
		</set>
			where payprotocolid = #{payProtocolid, jdbcType=VARCHAR}
	</update>
	<update id="PMPayment_updatePaySuccessByPayProtocol" parameterType="Map">
		update PMPayment  set modifydate = #{modifydate, jdbcType=TIMESTAMP},verifycode = #{verifycode, jdbcType=VARCHAR},status ='2'
		 where payprotocolid = #{payprotocolid}
	</update>
	<update id="PMPayment_updatePayProtocolNullByPayProtocol" parameterType="Map">
		update PMPayment  set payprotocolid='', modifydate = #{modifydate, jdbcType=TIMESTAMP},status ='0'
		 where payprotocolid = #{payprotocolid}
	</update>
	<update id="PMPayment_updatePaymentDataById" parameterType="Map">
		update PMPayment  set  
		modifydate = #{modifydate, jdbcType=TIMESTAMP},
		protocolid = #{protocolid, jdbcType=VARCHAR},
		app_id = #{appId, jdbcType=BIGINT},
		bankcard_id = #{bankCardId, jdbcType=BIGINT},
		platform_id = #{paymentPlatformId, jdbcType=BIGINT}
		 where id = #{id}
	</update>
	<update id="PMPayment_updatePayProtocolById" parameterType="Map">
		update PMPayment  set  modifydate = #{modifydate, jdbcType=TIMESTAMP},payprotocolid = #{payProtocol, jdbcType=VARCHAR}
		 where id = #{id}
	</update>
	<update id="PMPayment_updatePayProtocolByProtocol" parameterType="Map">
		update PMPayment  set modifydate = #{modifydate, jdbcType=TIMESTAMP},payprotocolid = #{payprotocolid, jdbcType=VARCHAR}
		 where protocolid = #{protocolid}
	</update>
	<select id="PMPayment_selectCount" parameterType="Map" resultType="Long">
		select count(1) from PMPayment
		<where>
			<if test="id != null">
				and id = #{id, jdbcType=BIGINT}
			</if>
			<if test="createdate != null">
				and createdate = #{createdate, jdbcType=TIMESTAMP}
			</if>
			<if test="modifydate != null">
				and modifydate = #{modifydate, jdbcType=TIMESTAMP}
			</if>
			<if test="appId != null">
				and app_id = #{appId, jdbcType=BIGINT}
			</if>
			<if test="platformId != null">
				and platform_id = #{platformId, jdbcType=BIGINT}
			</if>
			<if test="bankcardId != null">
				and bankcard_id = #{bankcardId, jdbcType=BIGINT}
			</if>
			<if test="protocolid != null">
				and protocolid = #{protocolid, jdbcType=VARCHAR}
			</if>
			<if test="payProtocolid != null">
				and payprotocolid = #{payProtocolid, jdbcType=VARCHAR}
			</if>
			<if test="orderid != null">
				and orderid = #{orderid, jdbcType=VARCHAR}
			</if>
			<if test="ordername != null">
				and ordername = #{ordername, jdbcType=VARCHAR}
			</if>
			<if test="appOrderId != null">
				and app_orderid = #{appOrderId, jdbcType=CHAR}
			</if>
			<if test="orderfee != null">
				and orderfee = #{orderfee, jdbcType=INTEGER}
			</if>
			<if test="payfee != null">
				and payfee = #{payfee, jdbcType=INTEGER}
			</if>
			<if test="payType != null">
				and pay_type = #{payType, jdbcType=CHAR}
			</if>
			<if test="orderdatetime != null">
				and orderdatetime = #{orderdatetime, jdbcType=CHAR}
			</if>
			<if test="verifycode != null">
				and verifycode = #{verifycode, jdbcType=VARCHAR}
			</if>
			<if test="bindCardVerifycode != null">
				and bind_card_verifycode = #{bindCardVerifycode, jdbcType=VARCHAR}
			</if>
			<if test="corpid != null">
				and corpid = #{corpid, jdbcType=VARCHAR}
			</if>
			<if test="itemid != null">
				and itemid = #{itemid, jdbcType=VARCHAR}
			</if>
			<if test="corpuserid != null">
				and corpuserid = #{corpuserid, jdbcType=VARCHAR}
			</if>
			<if test="corpusername != null">
				and corpusername = #{corpusername, jdbcType=VARCHAR}
			</if>
			<if test="status != null">
				and status = #{status, jdbcType=CHAR}
			</if>
			<if test="payresultcode != null">
				and payresultcode = #{payresultcode, jdbcType=VARCHAR}
			</if>
			<if test="payresultmsg != null">
				and payresultmsg = #{payresultmsg, jdbcType=VARCHAR}
			</if>
			<if test="receiveurl != null">
				and receiveurl = #{receiveurl, jdbcType=VARCHAR}
			</if>
			<if test="userinfourl != null">
				and userinfourl = #{userinfourl, jdbcType=VARCHAR}
			</if>
			<if test="appUserId != null">
				and app_user_id = #{appUserId, jdbcType=VARCHAR}
			</if>
			<if test="prop1 != null">
				and prop1 = #{prop1, jdbcType=VARCHAR}
			</if>
			<if test="prop2 != null">
				and prop2 = #{prop2, jdbcType=VARCHAR}
			</if>
			<if test="prop3 != null">
				and prop3 = #{prop3, jdbcType=VARCHAR}
			</if>
			<if test="prop4 != null">
				and prop4 = #{prop4, jdbcType=VARCHAR}
			</if>
			<if test="prop5 != null">
				and prop5 = #{prop5, jdbcType=VARCHAR}
			</if>
		</where>
	</select>
	<select id="PMPayment_selectOne" parameterType="Map" resultMap="PMPaymentMap">
		select * from PMPayment
		<where>
			<if test="id != null">
				and id = #{id, jdbcType=BIGINT}
			</if>
			<if test="createdate != null">
				and createdate = #{createdate, jdbcType=TIMESTAMP}
			</if>
			<if test="modifydate != null">
				and modifydate = #{modifydate, jdbcType=TIMESTAMP}
			</if>
			<if test="appId != null">
				and app_id = #{appId, jdbcType=BIGINT}
			</if>
			<if test="platformId != null">
				and platform_id = #{platformId, jdbcType=BIGINT}
			</if>
			<if test="bankcardId != null">
				and bankcard_id = #{bankcardId, jdbcType=BIGINT}
			</if>
			<if test="protocolid != null">
				and protocolid = #{protocolid, jdbcType=VARCHAR}
			</if>
			<if test="payProtocolid != null">
				and payprotocolid = #{payProtocolid, jdbcType=VARCHAR}
			</if>
			<if test="orderid != null">
				and orderid = #{orderid, jdbcType=VARCHAR}
			</if>
			<if test="ordername != null">
				and ordername = #{ordername, jdbcType=VARCHAR}
			</if>
			<if test="appOrderId != null">
				and app_orderid = #{appOrderId, jdbcType=CHAR}
			</if>
			<if test="orderfee != null">
				and orderfee = #{orderfee, jdbcType=INTEGER}
			</if>
			<if test="payfee != null">
				and payfee = #{payfee, jdbcType=INTEGER}
			</if>
			<if test="payType != null">
				and pay_type = #{payType, jdbcType=CHAR}
			</if>
			<if test="orderdatetime != null">
				and orderdatetime = #{orderdatetime, jdbcType=CHAR}
			</if>
			<if test="verifycode != null">
				and verifycode = #{verifycode, jdbcType=VARCHAR}
			</if>
			<if test="bindCardVerifycode != null">
				and bind_card_verifycode = #{bindCardVerifycode, jdbcType=VARCHAR}
			</if>
			<if test="corpid != null">
				and corpid = #{corpid, jdbcType=VARCHAR}
			</if>
			<if test="itemid != null">
				and itemid = #{itemid, jdbcType=VARCHAR}
			</if>
			<if test="corpuserid != null">
				and corpuserid = #{corpuserid, jdbcType=VARCHAR}
			</if>
			<if test="corpusername != null">
				and corpusername = #{corpusername, jdbcType=VARCHAR}
			</if>
			<if test="status != null">
				and status = #{status, jdbcType=CHAR}
			</if>
			<if test="payresultcode != null">
				and payresultcode = #{payresultcode, jdbcType=VARCHAR}
			</if>
			<if test="payresultmsg != null">
				and payresultmsg = #{payresultmsg, jdbcType=VARCHAR}
			</if>
			<if test="receiveurl != null">
				and receiveurl = #{receiveurl, jdbcType=VARCHAR}
			</if>
			<if test="userinfourl != null">
				and userinfourl = #{userinfourl, jdbcType=VARCHAR}
			</if>
			<if test="appUserId != null">
				and app_user_id = #{appUserId, jdbcType=VARCHAR}
			</if>
			<if test="prop1 != null">
				and prop1 = #{prop1, jdbcType=VARCHAR}
			</if>
			<if test="prop2 != null">
				and prop2 = #{prop2, jdbcType=VARCHAR}
			</if>
			<if test="prop3 != null">
				and prop3 = #{prop3, jdbcType=VARCHAR}
			</if>
			<if test="prop4 != null">
				and prop4 = #{prop4, jdbcType=VARCHAR}
			</if>
			<if test="prop5 != null">
				and prop5 = #{prop5, jdbcType=VARCHAR}
			</if>
		</where>
		LIMIT 2
	</select>
	
	<select id="PMPayment_getOrdersListCount" resultType="long" parameterType="Map">
		select count(1) 
		from pmpayment t 
		<where>
			t.`status`= '2' and t.platform_id=#{id}
			<if test="startdate != null and startdate != ''">
				and t.modifydate >= DATE_FORMAT(#{startdate}, '%Y-%m-%d %H:%i:%s')
			</if>
			<if test="enddate != null and enddate != ''">
				and DATE_FORMAT(#{enddate}, '%Y-%m-%d %H:%i:%s') >= t.modifydate 
			</if>
			<if test="payprotocolid != null and payprotocolid != ''">
				and t.payprotocolid = #{payprotocolid, jdbcType=VARCHAR}
			</if>
			<if test="orderid != null and orderid != ''">
				and t.orderid = #{orderid, jdbcType=VARCHAR}
			</if>
		</where>
	</select>
	<select id="PMPayment_selectOrdersList" resultType="Map" parameterType="Map">
		select DISTINCT t.id,t.payprotocolid,t.app_orderid,t.payfee,t.modifydate,max(p.modifydate) arrivaltime,t.`status` from pmpayment t 
		left join pmproducts p on p.payment_id=t.id and p.statement_status='0'
		<where>
			t.`status` = '2' and t.platform_id=#{id}
			<if test="startdate != null and startdate != ''">
				and t.modifydate >= DATE_FORMAT(#{startdate}, '%Y-%m-%d')
			</if>
			<if test="enddate != null and enddate != ''">
				and DATE_FORMAT(#{enddate}, '%Y-%m-%d') >= t.modifydate 
			</if>
			<if test="payprotocolid != null and payprotocolid != ''">
				and t.payprotocolid = #{payprotocolid, jdbcType=VARCHAR}
			</if>
			<if test="orderid != null and orderid != ''">
				and t.orderid = #{orderid, jdbcType=VARCHAR}
			</if>
		</where>
		group by t.id,t.payprotocolid,t.app_orderid,t.payfee,t.modifydate,t.`status`
		<if test="sort != null and order != null">
			order by ${sort}  ${order}
		</if>
		<if test="sort == null">
			order by t.createdate desc
		</if>
		limit #{offset},#{limit}
	</select>
	
	
	<select id="PMPayment_getForMoneys" resultType="String" parameterType="com.cninsure.payment.model.PlatformModel">
		 select sum(p.payfee) payfee from pmpayment p where p.`status`= '2'
		 <if test="id != null and id != ''">
			and p.platform_id=${id}
		</if>
		<if test="id == null or id == ''">
			and 1=0
		</if>
		<if test="startdate != null and startdate != ''">
			and DATE_FORMAT(p.modifydate, '%Y-%m-%d')>=#{startdate}
		</if>
		<if test="enddate != null and enddate != ''">
			and #{enddate}>=DATE_FORMAT(p.modifydate, '%Y-%m-%d')
		</if>
		<if test="querydate != null and querydate != ''">
			and #{querydate}=DATE_FORMAT(p.modifydate, '%Y-%m-%d')
		</if>
	</select>
	<select id="PMPayment_getOutMoneys" resultType="String" parameterType="com.cninsure.payment.model.PlatformModel">
	 select sum(pp.orderfee) payfee from pmpayment p
	 left join pmproducts pp on pp.payment_id=p.id and pp.statement_status='0' where p.`status`= '2'
		 <if test="id != null and id != ''">
			and p.platform_id=${id}
		</if>
		<if test="id == null or id == ''">
			and 1=0
		</if>
		<if test="startdate != null and startdate != ''">
			and DATE_FORMAT(p.modifydate, '%Y-%m-%d')>=#{startdate}
		</if>
		<if test="enddate != null and enddate != ''">
			and #{enddate}>=DATE_FORMAT(p.modifydate, '%Y-%m-%d')
		</if>
		<if test="querydate != null and querydate != ''">
			and #{querydate}=DATE_FORMAT(p.modifydate, '%Y-%m-%d')
		</if>
	</select>
	
	<select id="PMPayment_selectPlatformList" resultType="Map" parameterType="Map">
		select p.id,p.platform_no platformNo,p.platform_name platformName,p.`status` platformStutas,
		IFNULL((select sum(m.payfee) from pmpayment m where m.platform_id=p.id and m.`status` ='2'
		<if test="querydate != null and querydate != ''">
		and #{querydate}=DATE_FORMAT(m.modifydate, '%Y-%m-%d')
		</if>
		<if test="querydate == null or querydate == ''">
		and DATE_FORMAT(m.modifydate, '%Y-%m-%d')=DATE_FORMAT(SYSDATE(), '%Y-%m-%d')
		</if>
		),0) todayforfee,
		IFNULL((select sum(m.payfee) from pmpayment m where m.platform_id=p.id and m.`status` ='2'
		<if test="startdate != null and startdate != ''">
		and DATE_FORMAT(m.modifydate, '%Y-%m-%d')>=#{startdate}
		</if>
		<if test="enddate != null and enddate != ''">
		and #{enddate}>=DATE_FORMAT(m.modifydate, '%Y-%m-%d')
		</if>
		),0) tomonthforfee, 
		IFNULL((select sum(pp.orderfee) from pmpayment m
		left join pmproducts pp on pp.payment_id=m.id and pp.statement_status='0' where m.platform_id=p.id and m.`status` ='2'
		<if test="querydate != null and querydate != ''">
		and #{querydate}=DATE_FORMAT(m.modifydate, '%Y-%m-%d')
		</if>
		<if test="querydate == null or querydate == ''">
		and DATE_FORMAT(m.modifydate, '%Y-%m-%d')=DATE_FORMAT(SYSDATE(), '%Y-%m-%d')
		</if>
		),0) todayoutfee,
		IFNULL((select sum(pp.orderfee) from pmpayment m 
		left join pmproducts pp on pp.payment_id=m.id and pp.statement_status='0' where m.platform_id=p.id and m.`status` ='2'
		<if test="startdate != null and startdate != ''">
		and DATE_FORMAT(m.modifydate, '%Y-%m-%d')>=#{startdate}
		</if>
		<if test="enddate != null and enddate != ''">
		and #{enddate}>=DATE_FORMAT(m.modifydate, '%Y-%m-%d')
		</if>
		),0) tomonthoutfee, 
		IFNULL((select sum(pf.payment_receivable_ratefee) from pmpayment m 
		left join pmratefee pf on pf.pay_id=m.id and pf.payment_ratefee_status='0' where m.platform_id=p.id and m.`status` ='2'
		<if test="startdate != null and startdate != ''">
		and DATE_FORMAT(m.modifydate, '%Y-%m-%d')>=#{startdate}
		</if>
		<if test="enddate != null and enddate != ''">
		and #{enddate}>=DATE_FORMAT(m.modifydate, '%Y-%m-%d')
		</if>
		),0) totalProceduresFee
		from pmpaymentplatform p
		<if test="sort != null and order != null">
			order by ${sort}  ${order}
		</if>
		<if test="sort == null">
			order by createdate desc
		</if>
		limit #{offset},#{limit}
	</select>
	
	<select id="PMPayment_getPlatformListCount" resultType="long" parameterType="Map">
		select count(1) from pmpaymentplatform p
	</select>
	
	<select id="PMPayment_selectAppPlatformList" resultType="Map" parameterType="Map">
		select p.id,p.platform_no platformNo,p.platform_name platformName,p.`status` platformStutas,
		IFNULL((select sum(m.payfee) from pmpayment m where m.app_id=p.id and m.`status` ='2' 
		<if test="querydate != null and querydate != ''">
		and #{querydate}=DATE_FORMAT(m.modifydate, '%Y-%m-%d')
		</if>
		<if test="querydate == null or querydate == ''">
		and DATE_FORMAT(m.modifydate, '%Y-%m-%d')=DATE_FORMAT(SYSDATE(), '%Y-%m-%d')
		</if>
		),0) todayforfee,
		IFNULL((select sum(m.payfee) from pmpayment m where m.app_id=p.id and m.`status` ='2' 
		<if test="startdate != null and startdate != ''">
		and DATE_FORMAT(m.modifydate, '%Y-%m-%d')>=#{startdate}
		</if>
		<if test="enddate != null and enddate != ''">
		and #{enddate}>=DATE_FORMAT(m.modifydate, '%Y-%m-%d')
		</if>
		),0) tomonthforfee, 
		IFNULL((select sum(pp.orderfee) from pmpayment m
		left join pmproducts pp on pp.payment_id=m.id and pp.statement_status='0' where m.app_id=p.id and m.`status` ='2'
		<if test="querydate != null and querydate != ''">
		and #{querydate}=DATE_FORMAT(m.modifydate, '%Y-%m-%d')
		</if>
		<if test="querydate == null or querydate == ''">
		and DATE_FORMAT(m.modifydate, '%Y-%m-%d')=DATE_FORMAT(SYSDATE(), '%Y-%m-%d')
		</if>
		),0) todayoutfee,
		IFNULL((select sum(pp.orderfee) from pmpayment m 
		left join pmproducts pp on pp.payment_id=m.id and pp.statement_status='0' where m.app_id=p.id and m.`status` ='2'
		<if test="startdate != null and startdate != ''">
		and DATE_FORMAT(m.modifydate, '%Y-%m-%d')>=#{startdate}
		</if>
		<if test="enddate != null and enddate != ''">
		and #{enddate}>=DATE_FORMAT(m.modifydate, '%Y-%m-%d')
		</if>
		),0) tomonthoutfee, 
		IFNULL((select sum(pf.app_receivable_ratefee) from pmpayment m 
		left join pmratefee pf on pf.pay_id=m.id and pf.app_ratefee_status='1' where m.app_id=p.id and m.`status` ='2'
		<if test="startdate != null and startdate != ''">
		and DATE_FORMAT(m.modifydate, '%Y-%m-%d')>=#{startdate}
		</if>
		<if test="enddate != null and enddate != ''">
		and #{enddate}>=DATE_FORMAT(m.modifydate, '%Y-%m-%d')
		</if>
		),0) totalProceduresFee
		from pmappplatform p
		<where>
			<if test="platformName != null and platformName != ''">
			 p.platform_name like concat('%',#{platformName},'%')  
			</if>
		</where>
		<if test="sort != null and order != null">
			order by ${sort}  ${order}
		</if>
		<if test="sort == null">
			order by createdate desc
		</if>
		limit #{offset},#{limit}
	</select>
	
	<select id="PMPayment_getAppPlatformListCount" resultType="long" parameterType="Map">
		select count(1) from pmappplatform p
	</select>
	
	
	<select id="PMPayment_getAppForMoneys" resultType="String" parameterType="com.cninsure.payment.model.AppCheckModel">
		 select sum(p.payfee) payfee from pmpayment p where p.`status`= '2'
		 <if test="id != null and id != ''">
			and p.app_id=${id}
		</if>
		<if test="id == null or id == ''">
			and 1=0
		</if>
		<if test="startdate != null and startdate != ''">
			and DATE_FORMAT(p.modifydate, '%Y-%m-%d')>=#{startdate}
		</if>
		<if test="enddate != null and enddate != ''">
			and #{enddate}>=DATE_FORMAT(p.modifydate, '%Y-%m-%d')
		</if>
		<if test="querydate != null and querydate != ''">
			and #{querydate}=DATE_FORMAT(p.modifydate, '%Y-%m-%d')
		</if>
	</select>
	<select id="PMPayment_getAppOutMoneys" resultType="String" parameterType="com.cninsure.payment.model.AppCheckModel">
		 select sum(p.payfee) payfee from pmpayment p 
		 left join pmproducts pp on pp.app_id=p.id and pp.statement_status='0' where p.`status`= '2'
		 <if test="id != null and id != ''">
			and p.app_id=${id}
		</if>
		<if test="id == null or id == ''">
			and 1=0
		</if>
		<if test="startdate != null and startdate != ''">
			and DATE_FORMAT(p.modifydate, '%Y-%m-%d')>=#{startdate}
		</if>
		<if test="enddate != null and enddate != ''">
			and #{enddate}>=DATE_FORMAT(p.modifydate, '%Y-%m-%d')
		</if>
		<if test="querydate != null and querydate != ''">
			and #{querydate}=DATE_FORMAT(p.modifydate, '%Y-%m-%d')
		</if>
	</select>
	
	<select id="PMPayment_getAppOrdersListCount" resultType="long" parameterType="Map">
		select count(1) 
		from pmpayment t 
		<where>
			t.`status`= '2' and t.app_id=#{id}
			<if test="startdate != null and startdate != ''">
				and t.modifydate >= DATE_FORMAT(#{startdate}, '%Y-%m-%d %H:%i:%s')
			</if>
			<if test="enddate != null and enddate != ''">
				and DATE_FORMAT(#{enddate}, '%Y-%m-%d %H:%i:%s') >= t.modifydate 
			</if>
			<if test="corpuserid != null and corpuserid != ''">
				and t.corpuserid = #{corpuserid, jdbcType=VARCHAR}
			</if>
			<if test="orderid != null and orderid != ''">
				and t.orderid = #{orderid, jdbcType=VARCHAR}
			</if>
		</where>
	</select>
	<select id="PMPayment_selectAppOrdersList" resultType="Map" parameterType="Map">
		select DISTINCT t.id,t.payprotocolid,t.app_orderid,t.payfee,t.modifydate,max(p.modifydate) arrivaltime,t.`status` from pmpayment t 
		left join pmproducts p on p.payment_id=t.id and p.statement_status='0'
		<where>
			t.`status` = '2' and t.app_id=#{id}
			<if test="startdate != null and startdate != ''">
				and t.modifydate >= DATE_FORMAT(#{startdate}, '%Y-%m-%d')
			</if>
			<if test="enddate != null and enddate != ''">
				and DATE_FORMAT(#{enddate}, '%Y-%m-%d') >= t.modifydate 
			</if>
			<if test="corpuserid != null and corpuserid != ''">
				and t.corpuserid = #{corpuserid, jdbcType=VARCHAR}
			</if>
			<if test="orderid != null and orderid != ''">
				and t.orderid = #{orderid, jdbcType=VARCHAR}
			</if>
		</where>
		group by t.id,t.payprotocolid,t.app_orderid,t.payfee,t.modifydate,t.`status`
		<if test="sort != null and order != null">
			order by ${sort}  ${order}
		</if>
		<if test="sort == null">
			order by t.createdate desc
		</if>
		limit #{offset},#{limit}
	</select>
	<select id="PMPayment_getPaymentReconList" resultType="Map" parameterType="Map">
		select IFNULL(s.selectdate,'') selectdate,IFNULL(count(s.txAmount),0) txcou,IFNULL(sum(s.txAmount),0) txAmount,
		IFNULL(count(s.payfee),0) paycou,IFNULL(sum(s.payfee),0) payfee from (
		SELECT t.selectdate,t.txSn,t.txAmount,p.payprotocolid,p.payfee from transaction1810 t 
		left join pmpayment p on t.txSn=p.payprotocolid and p.`status`='2'
		where t.selectdate >=#{startdate} and #{enddate}>=t.selectdate 
		UNION
		SELECT DATE_FORMAT(p.modifydate,'%Y-%m-%d') selectdate,t.txSn,t.txAmount,p.payprotocolid,p.payfee from pmpayment p 
		left join transaction1810 t on t.txSn=p.payprotocolid 
		where DATE_FORMAT(p.modifydate,'%Y-%m-%d') >=#{startdate} and #{enddate}>=DATE_FORMAT(p.modifydate,'%Y-%m-%d') 
		and p.`status`='2'
		)s
		GROUP BY s.selectdate
		<if test="sort != null and order != null">
			order by ${sort}  ${order}
		</if>
		<if test="sort == null">
			order by s.selectdate desc
		</if>
		<if test="limit != null and limit != ''">
			limit #{offset},#{limit}
		</if>
	</select>
	<select id="PMPayment_getPaymentReconDetailList" resultType="Map" parameterType="Map">
		select IFNULL(s.payprotocolid,'') payprotocolid,IFNULL(s.orderid,'') orderid,IFNULL(s.platform_name,'') platform_name,
		IFNULL(s.app_name,'') app_name,IFNULL(s.txSn,'') txSn,IFNULL(s.payfee,0) payfee,IFNULL(s.txAmount,0) txAmount
		,IFNULL(case when s.payprotocolid is null and s.txSn is null then '有订单却没有支付流水号和中金没有支付信息' 
		when s.payprotocolid is null then '没有支付流水号' when s.txSn is null then '中金没有支付信息' 
		when s.payfee != s.txAmount then '支付金额不等' else '成功'end,'') trcon
		from(
		select p.payprotocolid,p.orderid,pf.platform_name platform_name,paf.platform_name app_name,t.txSn,p.payfee,t.txAmount from pmpayment p 
		left join transaction1810 t on t.txSn=p.payprotocolid and t.selectdate=#{selectdate}
		left join pmpaymentplatform pf on pf.id=p.platform_id
		left join pmappplatform paf on paf.id=p.app_id
		where p.`status`='2' and DATE_FORMAT(p.modifydate, '%Y-%m-%d')=#{selectdate}
		union 
		select p.payprotocolid,p.orderid,pf.platform_name platform_name,paf.platform_name app_name,t.txSn,p.payfee,t.txAmount from transaction1810 t
		left join pmpayment p  on t.txSn=p.payprotocolid and p.`status`='2' and DATE_FORMAT(p.modifydate, '%Y-%m-%d')=#{selectdate}
		left join pmpaymentplatform pf on pf.id=p.platform_id
		left join pmappplatform paf on paf.id=p.app_id
		where t.selectdate=#{selectdate}
		)s
		<where>
		1=1
			<if test="orderid != null and orderid != ''">
				and s.orderid = #{orderid} 
			</if>
			<if test="platform_name != null and platform_name != ''">
				and s.platform_name like concat('%',#{platform_name},'%')  
			</if>
			<if test="app_name != null and app_name != ''">
				and s.app_name like concat('%',#{app_name},'%')  
			</if>
		</where>
		<if test="limit != null and limit != ''">
			limit #{offset},#{limit}
		</if>
	</select>
	
	<select id="PMPayment_getTransaction1810List" resultType="Map" parameterType="Map">
		select * from Transaction1810 t 
		<where>
			<if test="today != null and today != ''">
				and t.selectdate = #{today}
			</if>
		</where>
	</select>
	
	
	<select id="PMPayment_insertTran1810" parameterType="Map" resultType="int">
		INSERT INTO `transaction1810` (`createtime`, `modifytime`, `selectdate`, `txType`, `txSn`,
		 `txAmount`, `institutionAmount`, `paymentAmount`, `institutionFee`, `payerFee`, `bankNotificationTime`, `remark`, `settlementFlag`)  VALUES 
		 <foreach collection="list" item="item" index="index" separator=",">
		   (sysdate(),sysdate(),#{item.selectdate,jdbcType=VARCHAR},#{item.txType,jdbcType=VARCHAR},#{item.txSn,jdbcType=VARCHAR},
		   #{item.txAmount,jdbcType=VARCHAR},#{item.institutionAmount,jdbcType=VARCHAR},#{item.paymentAmount,jdbcType=VARCHAR},
		   #{item.institutionFee,jdbcType=VARCHAR},#{item.payerFee,jdbcType=VARCHAR},#{item.bankNotificationTime,jdbcType=TIMESTAMP},
		   #{item.remark,jdbcType=VARCHAR},#{item.settlementFlag,jdbcType=VARCHAR})
		 </foreach>
	</select>
	
	
	
	<select id="PMPayment_selectAllOrdersList" resultType="Map" parameterType="Map">
		select t.*,p.platform_name from pmpayment t 
		left join pmappplatform p on t.app_id=p.id
		<where>
			<if test="startdate != null and startdate != ''">
				and t.orderdatetime >= #{startdate} 
			</if>
			<if test="enddate != null and enddate != ''">
				and #{enddate} >= t.orderdatetime 
			</if>
			<if test="platformName != null and platformName != ''">
				and p.platform_name = #{platformName, jdbcType=VARCHAR}
			</if>
			<if test="appOrderid != null and appOrderid != ''">
				and t.app_orderid = #{appOrderid, jdbcType=VARCHAR}
			</if>
			<if test="status != null and status != ''">
				and t.`status` = #{status, jdbcType=VARCHAR}
			</if>
		</where>
		<if test="sort != null and order != null">
			order by ${sort}  ${order}
		</if>
		<if test="sort == null">
			order by createdate desc
		</if>
		limit #{offset},#{limit}
	</select>
	<select id="PMPayment_getAllOrdersListCount" resultType="long" parameterType="Map">
		select count(1) from pmpayment t 
		left join pmappplatform p on t.app_id=p.id
		<where>
			<if test="startdate != null and startdate != ''">
				and t.orderdatetime >= #{startdate} 
			</if>
			<if test="enddate != null and enddate != ''">
				and #{enddate} >= t.orderdatetime 
			</if>
			<if test="platformName != null and platformName != ''">
				and p.platform_name = #{platformName, jdbcType=VARCHAR}
			</if>
			<if test="appOrderid != null and appOrderid != ''">
				and t.app_orderid = #{appOrderid, jdbcType=VARCHAR}
			</if>
			<if test="status != null and status != ''">
				and t.`status` = #{status, jdbcType=VARCHAR}
			</if>
		</where>
	</select>
	
	<select id="PMPayment_selectOrdersDetailById" parameterType="String" resultType="com.cninsure.payment.model.OrdersDetailModel">
		SELECT p.id,pa.platform_name app_name,p.app_orderid,pp.platform_name,pb.bankcode,pbs.bank_name bankname,
			case when pb.card_type='20' then '信用卡' else '储蓄卡' end card_type,pb.customphone,pb.customcardno,pb.validdate,pb.cvn2,
			p.protocolid,p.payprotocolid,p.orderid,p.orderfee,p.payfee,p.orderdatetime,
			case when p.`status`='0' then '待支付' when p.`status`='1' then '支付中' when p.`status`='2' then '支付成功' 
			when p.`status`='3' then '支付失败' else '支付取消' end `status`,p.receiveurl,p.userinfourl,p.app_user_id,
			case when p.`pay_type`='1' then '1361-结算支付' when p.`pay_type`='2' then '2011-直接支付' end `pay_type`
			from pmpayment p 
			left join pmappplatform pa on pa.id=p.app_id
			left join pmpaymentplatform pp on pp.id=p.platform_id
			left join pmbankcard pb on pb.protocolid=p.protocolid
			left join pmbanks pbs on pbs.bank_code=pb.bankcode
			where p.id=#{value}
	</select>
	<select id="PMPayment_getVerifyCode" parameterType="Map" resultType="String">
		SELECT p.bind_card_verifycode from pmpayment p where p.id=#{paymentId}
	</select>
	<select id="PMPayment_selectDirectPayment2011List" resultType="Map" parameterType="Map">
		select p.*,ap.platform_name from pmpayment p 
		left join pmappplatform ap on ap.id=p.app_id
		<where>
			 p.pay_type ='2' and p.platform_id is not null
			<if test="platformName != null and platformName != ''">
				and ap.platform_name like concat('%',#{platformName},'%')  
			</if>
			<if test="startdate != null and startdate != ''">
				and p.orderdatetime >= #{startdate} 
			</if>
			<if test="enddate != null and enddate != ''">
				and #{enddate} >= p.orderdatetime 
			</if>
			<if test="appOrderId != null and appOrderId != ''">
				and p.app_orderid like concat('%',#{appOrderId},'%')  
			</if>
			<if test="orderid != null and orderid != ''">
				and p.orderid like concat('%',#{orderid},'%')  
			</if>
			<if test="protocolid != null and protocolid != ''">
				and p.protocolid = #{protocolid, jdbcType=VARCHAR}
			</if>
			<if test="payProtocolid != null and payProtocolid != ''">
				and p.payprotocolid = #{payProtocolid, jdbcType=VARCHAR}
			</if>
			<if test="orderfee != null and orderfee != ''">
				and p.orderfee = #{orderfee, jdbcType=VARCHAR}
			</if>
			<if test="appUserId != null and appUserId != ''">
				and p.app_user_id like concat('%',#{appUserId},'%')  
			</if>
			<if test="status != null and status != ''">
				and p.`status` = #{status, jdbcType=VARCHAR}
			</if>
		</where>
		<if test="sort != null and order != null">
			order by ${sort}  ${order}
		</if>
		<if test="sort == null">
			order by p.createdate desc
		</if>
		limit #{offset},#{limit}
	</select>
	<select id="PMPayment_selectDirectPayment2011ListCount" resultType="long" parameterType="Map">
		select count(1) from pmpayment p 
		left join pmappplatform ap on ap.id=p.app_id
		<where>
			p.pay_type ='2' and p.platform_id is not null
			<if test="platformName != null and platformName != ''">
				and ap.platform_name like concat('%',#{platformName},'%')  
			</if>
			<if test="startdate != null and startdate != ''">
				and p.orderdatetime >= #{startdate} 
			</if>
			<if test="enddate != null and enddate != ''">
				and #{enddate} >= p.orderdatetime 
			</if>
			<if test="appOrderId != null and appOrderId != ''">
				and p.app_orderid like concat('%',#{appOrderId},'%')  
			</if>
			<if test="orderid != null and orderid != ''">
				and p.orderid like concat('%',#{orderid},'%')  
			</if>
			<if test="protocolid != null and protocolid != ''">
				and p.protocolid = #{protocolid, jdbcType=VARCHAR}
			</if>
			<if test="payProtocolid != null and payProtocolid != ''">
				and p.payprotocolid = #{payProtocolid, jdbcType=VARCHAR}
			</if>
			<if test="orderfee != null and orderfee != ''">
				and p.orderfee = #{orderfee, jdbcType=VARCHAR}
			</if>
			<if test="appUserId != null and appUserId != ''">
				and p.app_user_id like concat('%',#{appUserId},'%')  
			</if>
			<if test="status != null and status != ''">
				and p.`status` = #{status, jdbcType=VARCHAR}
			</if>
		</where>
	</select>
	<select id="PMPayment_selectSettlePayment1361List" resultType="Map" parameterType="Map">
		select p.*,ap.platform_name from pmpayment p 
		left join pmappplatform ap on ap.id=p.app_id
		<where>
			 p.pay_type ='1' and p.platform_id is not null
			<if test="platformName != null and platformName != ''">
				and ap.platform_name like concat('%',#{platformName},'%')  
			</if>
			<if test="startdate != null and startdate != ''">
				and p.orderdatetime >= #{startdate} 
			</if>
			<if test="enddate != null and enddate != ''">
				and #{enddate} >= p.orderdatetime 
			</if>
			<if test="appOrderId != null and appOrderId != ''">
				and p.app_orderid like concat('%',#{appOrderId},'%')  
			</if>
			<if test="orderid != null and orderid != ''">
				and p.orderid like concat('%',#{orderid},'%')  
			</if>
			<if test="protocolid != null and protocolid != ''">
				and p.protocolid = #{protocolid, jdbcType=VARCHAR}
			</if>
			<if test="payProtocolid != null and payProtocolid != ''">
				and p.payprotocolid = #{payProtocolid, jdbcType=VARCHAR}
			</if>
			<if test="orderfee != null and orderfee != ''">
				and p.orderfee = #{orderfee, jdbcType=VARCHAR}
			</if>
			<if test="appUserId != null and appUserId != ''">
				and p.app_user_id like concat('%',#{appUserId},'%')  
			</if>
			<if test="status != null and status != ''">
				and p.`status` = #{status, jdbcType=VARCHAR}
			</if>
		</where>
		<if test="sort != null and order != null">
			order by ${sort}  ${order}
		</if>
		<if test="sort == null">
			order by p.createdate desc
		</if>
		limit #{offset},#{limit}
	</select>
	<select id="PMPayment_selectSettlePayment1361ListCount" resultType="long" parameterType="Map">
		select count(1) from pmpayment p 
		left join pmappplatform ap on ap.id=p.app_id
		<where>
			 p.pay_type ='1' and p.platform_id is not null
			<if test="platformName != null and platformName != ''">
				and ap.platform_name like concat('%',#{platformName},'%')  
			</if>
			<if test="startdate != null and startdate != ''">
				and p.orderdatetime >= #{startdate} 
			</if>
			<if test="enddate != null and enddate != ''">
				and #{enddate} >= p.orderdatetime 
			</if>
			<if test="appOrderId != null and appOrderId != ''">
				and p.app_orderid like concat('%',#{appOrderId},'%')  
			</if>
			<if test="orderid != null and orderid != ''">
				and p.orderid like concat('%',#{orderid},'%')  
			</if>
			<if test="protocolid != null and protocolid != ''">
				and p.protocolid = #{protocolid, jdbcType=VARCHAR}
			</if>
			<if test="payProtocolid != null and payProtocolid != ''">
				and p.payprotocolid = #{payProtocolid, jdbcType=VARCHAR}
			</if>
			<if test="orderfee != null and orderfee != ''">
				and p.orderfee = #{orderfee, jdbcType=VARCHAR}
			</if>
			<if test="appUserId != null and appUserId != ''">
				and p.app_user_id like concat('%',#{appUserId},'%')  
			</if>
			<if test="status != null and status != ''">
				and p.`status` = #{status, jdbcType=VARCHAR}
			</if>
		</where>
	</select>
	<select id="PMPayment_selectSettleProduct1341List" resultType="Map" parameterType="Map">
		SELECT * FROM pmproducts 
		<where>
			payment_id=#{paymentid}
			<if test="appOrderId != null and appOrderId != ''">
				and app_orderid = #{appOrderId, jdbcType=VARCHAR}
			</if>
			<if test="orderid != null and orderid != ''">
				and orderid = #{orderid, jdbcType=VARCHAR}
			</if>
			<if test="appOrderName != null and appOrderName != ''">
				and app_ordername = #{appOrderName, jdbcType=VARCHAR}
			</if>
			<if test="statementProtocolid != null and statementProtocolid != ''">
				and statement_protocolid = #{statementProtocolid, jdbcType=VARCHAR}
			</if>
			<if test="accountType != null and accountType != ''">
				and account_type = #{accountType, jdbcType=VARCHAR}
			</if>
			<if test="accountNumber != null and accountNumber != ''">
				and account_number = #{accountNumber, jdbcType=VARCHAR}
			</if>
			<if test="status != null and status != ''">
				and `status` = #{status, jdbcType=VARCHAR}
			</if>
			<if test="statementStatus != null and statementStatus != ''">
				and statement_status = #{statementStatus, jdbcType=VARCHAR}
			</if>
		</where>
		<if test="sort != null and order != null">
			order by ${sort}  ${order}
		</if>
		<if test="sort == null">
			order by createdate desc
		</if>
		limit #{offset},#{limit}
	</select>
	<select id="PMPayment_selectSettleProduct1341ListCount" resultType="long" parameterType="Map">
		SELECT count(1) FROM pmproducts 
		<where>
			payment_id=#{paymentid}
			<if test="appOrderId != null and appOrderId != ''">
				and app_orderid = #{appOrderId, jdbcType=VARCHAR}
			</if>
			<if test="orderid != null and orderid != ''">
				and orderid = #{orderid, jdbcType=VARCHAR}
			</if>
			<if test="appOrderName != null and appOrderName != ''">
				and app_ordername = #{appOrderName, jdbcType=VARCHAR}
			</if>
			<if test="statementProtocolid != null and statementProtocolid != ''">
				and statement_protocolid = #{statementProtocolid, jdbcType=VARCHAR}
			</if>
			<if test="accountType != null and accountType != ''">
				and account_type = #{accountType, jdbcType=VARCHAR}
			</if>
			<if test="accountNumber != null and accountNumber != ''">
				and account_number = #{accountNumber, jdbcType=VARCHAR}
			</if>
			<if test="status != null and status != ''">
				and `status` = #{status, jdbcType=VARCHAR}
			</if>
			<if test="statementStatus != null and statementStatus != ''">
				and statement_status = #{statementStatus, jdbcType=VARCHAR}
			</if>
		</where>
	</select>
</mapper>