<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cninsure.payment.entity">
	<resultMap id="PMApppaymentMap" type="com.cninsure.payment.entity.PMApppayment" >
    <id column="id" property="id" jdbcType="BIGINT" />
    <result column="createdate" property="createdate" jdbcType="TIMESTAMP" />
    <result column="modifydate" property="modifydate" jdbcType="TIMESTAMP" />
    <result column="app_id" property="appId" jdbcType="BIGINT" />
    <result column="payment_id" property="paymentId" jdbcType="BIGINT" />
    <result column="status" property="status" jdbcType="CHAR" />
    <result column="business_no" property="businessNo" jdbcType="VARCHAR" />
    <result column="business_type" property="businessType" jdbcType="CHAR" />
  </resultMap>
	<!-- PMApppayment -->
	<resultMap id="PmpaymentplatformResultMap" type="com.cninsure.payment.entity.PMPaymentplatform">
		<id column="id" property="id" jdbcType="BIGINT" />
		<result column="createdate" property="createdate" jdbcType="TIMESTAMP" />
		<result column="modifydate" property="modifydate" jdbcType="TIMESTAMP" />
		<result column="platform_no" property="platformNo" jdbcType="VARCHAR" />
		<result column="platform_name" property="platformName" jdbcType="VARCHAR" />
		<result column="platform_logo" property="platformLogo" jdbcType="VARCHAR" />
		<result column="status" property="status" jdbcType="CHAR" />
		<result column="settlement_interval" property="settlementInterval" jdbcType="INTEGER" />
		<result column="settlement_type" property="settlementType" jdbcType="CHAR" />
	</resultMap>
	
	<insert id="PMApppayment_insert" useGeneratedKeys="true"
		keyProperty="id" parameterType="com.cninsure.payment.entity.PMApppayment">
		insert into PMApppayment
		(createdate,modifydate,app_id,payment_id,status,business_no,business_type)
		values
		(#{createdate, jdbcType=TIMESTAMP},#{modifydate,
		jdbcType=TIMESTAMP},#{appId, jdbcType=BIGINT},#{paymentId,
		jdbcType=BIGINT},#{status, jdbcType=CHAR},#{businessNo,
		jdbcType=VARCHAR},#{businessType, jdbcType=CHAR})
	</insert>
	<select id="PMApppayment_select" parameterType="Map"
		resultMap="PMApppaymentMap">
		select * from PMApppayment
		<where>
			<if test="id != null">
				and id = #{id, jdbcType=BIGINT}
			</if>
			<if test="createdate != null">
				and createdate = #{createdate, jdbcType=TIMESTAMP}
			</if>
			<if test="modifydate != null">
				and modifydate = #{modifydate, jdbcType=TIMESTAMP}
			</if>
			<if test="appId != null">
				and app_id = #{appId, jdbcType=BIGINT}
			</if>
			<if test="paymentId != null">
				and payment_id = #{paymentId, jdbcType=BIGINT}
			</if>
			<if test="status != null">
				and status = #{status, jdbcType=CHAR}
			</if>
			<if test="businessNo != null">
				and business_no = #{businessNo, jdbcType=VARCHAR}
			</if>
			<if test="businessType != null">
				and business_type = #{businessType, jdbcType=CHAR}
			</if>
		</where>
	</select>
	<select id="PMApppayment_selectById" parameterType="Long"
		resultMap="PMApppaymentMap">
		select * from PMApppayment where id = #{id}
	</select>
	<select id="PMApppayment_deleteById" parameterType="Long">
		delete from
		PMApppayment where id = #{id}
	</select>
	<select id="PMApppayment_updateById" parameterType="com.cninsure.payment.entity.PMApppayment">
		update
		PMApppayment set id = #{id, jdbcType=BIGINT},createdate =
		#{createdate, jdbcType=TIMESTAMP},modifydate = #{modifydate,
		jdbcType=TIMESTAMP},app_id = #{appId, jdbcType=BIGINT},payment_id =
		#{paymentId, jdbcType=BIGINT},status = #{status,
		jdbcType=CHAR},business_no = #{businessNo,
		jdbcType=VARCHAR},business_type = #{businessType, jdbcType=CHAR} where
		id = #{id}
	</select>
	<select id="PMApppayment_selectCount" parameterType="Map"
		resultType="Long">
		select count(1) from PMApppayment
		<where>
			<if test="id != null">
				and id = #{id, jdbcType=BIGINT}
			</if>
			<if test="createdate != null">
				and createdate = #{createdate, jdbcType=TIMESTAMP}
			</if>
			<if test="modifydate != null">
				and modifydate = #{modifydate, jdbcType=TIMESTAMP}
			</if>
			<if test="appId != null">
				and app_id = #{appId, jdbcType=BIGINT}
			</if>
			<if test="paymentId != null">
				and payment_id = #{paymentId, jdbcType=BIGINT}
			</if>
			<if test="status != null">
				and status = #{status, jdbcType=CHAR}
			</if>
			<if test="businessNo != null">
				and business_no = #{businessNo, jdbcType=VARCHAR}
			</if>
			<if test="businessType != null">
				and business_type = #{businessType, jdbcType=CHAR}
			</if>
		</where>
	</select>
	<select id="PMApppayment_selectOne" parameterType="Map"
		resultMap="PMApppaymentMap">
		select * from PMApppayment
		<where>
			<if test="id != null">
				and id = #{id, jdbcType=BIGINT}
			</if>
			<if test="createdate != null">
				and createdate = #{createdate, jdbcType=TIMESTAMP}
			</if>
			<if test="modifydate != null">
				and modifydate = #{modifydate, jdbcType=TIMESTAMP}
			</if>
			<if test="appId != null">
				and app_id = #{appId, jdbcType=BIGINT}
			</if>
			<if test="paymentId != null">
				and payment_id = #{paymentId, jdbcType=BIGINT}
			</if>
			<if test="status != null">
				and status = #{status, jdbcType=CHAR}
			</if>
			<if test="businessNo != null">
				and business_no = #{businessNo, jdbcType=VARCHAR}
			</if>
			<if test="businessType != null">
				and business_type = #{businessType, jdbcType=CHAR}
			</if>
		</where>
		LIMIT 2
	</select>
	<select id="PMApppayment_quertPaymentsByAppId" parameterType="String"
		resultMap="PmpaymentplatformResultMap">
		select pp.* from PMApppayment ap
		left join PMPaymentplatform pp on ap.payment_id=pp.id
		left join pmpaymentrate pr on pr.payment_id=ap.payment_id
		<where>
			ap.app_id=#{value} and ap.status=0
		</where>
		order by pr.rate
	</select>
</mapper>