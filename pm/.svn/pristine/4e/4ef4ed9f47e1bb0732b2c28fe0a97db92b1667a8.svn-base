package com.cninsure.payment.dao.impl;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.springframework.stereotype.Repository;

import com.cninsure.core.dao.impl.BaseDaoImpl;
import com.cninsure.payment.dao.PMPaymentrateDao;
import com.cninsure.payment.entity.PMPaymentplatform;
import com.cninsure.payment.entity.PMPaymentrate;

@Repository
public class PMPaymentrateDaoImpl extends BaseDaoImpl<PMPaymentrate,Long> implements
		PMPaymentrateDao {

	@Override
	public int saveRate(PMPaymentrate pmpaymentrate) {
		this.sqlSessionTemplate.insert("PMPaymentrate_saveRate", pmpaymentrate);
		return 0;
	}

	@Override
	public int updateRate(PMPaymentrate pmpaymentrate) {
		this.sqlSessionTemplate.insert("PMPaymentrate_back_rate",pmpaymentrate);//备份
		return this.sqlSessionTemplate.update("PMPaymentrate_updateRate", pmpaymentrate);
	}

	@Override
	public int deleteRate(PMPaymentrate pmpaymentrate) {
		
		this.sqlSessionTemplate.insert("PMPaymentrate_back_rate",pmpaymentrate);//备份
		return this.sqlSessionTemplate.delete("PMPaymentrate_deleteRate", pmpaymentrate);
	}

	@Override
	public PMPaymentrate selectRate(PMPaymentrate pmpaymentrate) {
		return this.sqlSessionTemplate.selectOne("PMPaymentrate_selectRate", pmpaymentrate);
	}

	@Override
	public List<Map<String, Object>> selectRateList(String id) {
		return this.sqlSessionTemplate.selectList("PMPaymentrate_selectRateList", id);
	}

	@Override
	public long getRateTrajectoryCount(Map<String, Object> map) {
		return this.sqlSessionTemplate.selectOne("PMPaymentrate_getRateTrajectoryCount", map);
	}

	@Override
	public List<Map<Object, Object>> selectRateTrajectoryList(Map<String, Object> map) {
		return this.sqlSessionTemplate.selectList("PMPaymentrate_selectRateTrajectoryList", map);
	}

	@Override
	public PMPaymentplatform getBestRate(int orderFee,long appId) {
		Map<String,Object> parameter = new HashMap<String, Object>();
		parameter.put("orderFee", orderFee);
		parameter.put("appId", appId);
		return this.sqlSessionTemplate.selectOne(this.getSqlName("getBestRate"), parameter);
	}

	@Override
	public PMPaymentrate getBestRateByPayPlatformId(int orderFee,long payPlatFormId) {
		Map<String,Object> parameter = new HashMap<String, Object>();
		parameter.put("orderFee", orderFee);
		parameter.put("payPlatFormId", payPlatFormId);
		
		return this.sqlSessionTemplate.selectOne(this.getSqlName("getBestRateByPayPlatformId"), parameter);
	}

}